# Config file for automatic testing at travis-ci.org
jobs:
  include:
    - stage: build pytorch-cifar10-resnet20-all-reduce
      language: bash
      sudo: required

      services:
        - docker
      install: true
      script:
        - docker build -t pytorch-cifar10-resnet20-all-reduce:travis-ci-test ./pytorch/imagerecognition/cifar10-resnet20-all-reduce

    - stage: build pytorch-cifar10-resnet20-all-reduce-scaling
      language: bash
      sudo: required

      services:
        - docker
      install: true
      script:
        - docker build -t pytorch-cifar10-resnet20-all-reduce-scaling:travis-ci-test ./pytorch/imagerecognition/cifar10-resnet20-all-reduce-scaling

    - stage: build pytorch-epsilon-logistic-regression-all-reduce
      language: bash
      sudo: required

      services:
        - docker
      install: true
      script:
        - docker build -t pytorch-epsilon-logistic-regression-all-reduce:travis-ci-test ./pytorch/linearmodels/epsilon-logistic-regression-all-reduce

    - stage: build pytorch-wmt17-transformer-all-reduce
      language: bash
      sudo: required

      services:
        - docker
      install: true
      script:
        - docker build -t pytorch-wmt17-transformer-all-reduce:travis-ci-test ./pytorch/translation/wmt17-transformer-all-reduce

    - stage: build pytorch-openmpi-wikitext2-rnn-lm
      language: bash
      sudo: required

      services:
        - docker
      install: true
      script:
        - docker build -t pytorch-openmpi-wikitext2-rnn-lm:travis-ci-test ./pytorch/nlp/openmpi-wikitext2-rnn-lm

    - stage: build tensorflow-base
      language: bash
      sudo: required

      services:
        - docker
      install: true
      script:
        - docker build -t mlbench-tensorflow-base:travis-ci-test ./tensorflow/base/

    - stage: build tensorflow-openmpi-cifar10-resnet20-all-reduce
      language: bash
      sudo: required

      services:
        - docker
      install: true
      script:
        - docker build -t tensorflow-openmpi-cifar10-resnet20-all-reduce:travis-ci-test ./tensorflow/imagerecognition/openmpi-cifar10-resnet20-all-reduce


stages:
  - build pytorch-cifar10-resnet20-all-reduce
  - build pytorch-cifar10-resnet20-all-reduce-scaling
  - build pytorch-epsilon-logistic-regression-all-reduce
  - build pytorch-wmt17-transformer-all-reduce
  - build pytorch-openmpi-wikitext2-rnn-lm
  - build tensorflow-openmpi-cifar10-resnet20-all-reduce
  - build tensorflow-base
